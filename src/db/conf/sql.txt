CREATE TABLE users(
	id SERIAL PRIMARY KEY NOT NULL, 
	username varchar(50) UNIQUE,
	realname varchar(50),
	email varchar(50) UNIQUE, CHECK (email <> ''),
	token varchar(50) NOT NULL UNIQUE, CHECK (token <> '')
);

CREATE TABLE bots(
	id SERIAL PRIMARY KEY NOT NULL,
	name varchar(50), CHECK (name <> ''),
	description text,
	tags varchar[],
	fs_path varchar(100)
);

CREATE TABLE projects(
	id SERIAL PRIMARY KEY NOT NULL,
	name varchar(50), CHECK (name <> ''),
	uid int4 REFERENCES users(id),
	clone_url varchar(100),
	fs_path varchar(100)
);

CREATE TABLE tasks(
	id SERIAL PRIMARY KEY NOT NULL,
	uid int4 REFERENCES users(id),
	pid int4 REFERENCES projects(id),
	bid int4 REFERENCES bots(id),
	rid int4 REFERENCES results(id),
	start_time date,
	end_time date,
	status varchar DEFAULT 0,
	exit_status varchar DEFAULT 0
);

CREATE TABLE members(
	id SERIAL PRIMARY KEY NOT NULL,
	uid int4 REFERENCES users(id),
	pid int4 REFERENCES projects(id)
);

CREATE TABLE results(
	id SERIAL PRIMARY KEY NOT NULL,
	output text
);

